<%- include("../partials/admin/admin-header.ejs"); -%>

<!--*Sort table script asc/desc-->
<script src="/js/table/sort.table.js"></script>
<!--*Sort table script asc/desc-->

<div class="container-fluid">
    <div class="row">
        <%- include("../partials/admin/admin-navbar.ejs"); -%>

        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div
                class="
                    d-flex
                    justify-content-between
                    flex-wrap flex-md-nowrap
                    align-items-center
                    border-bottom
                    shadow-lg
                    p-3
                    mb-5
                    bg-white
                    rounded
                "
            >
                <h4>
                    <i class="fas fa-list-ol"></i> List of Panoramas (SanJuan
                    Campus)
                </h4>
            </div>
            <%- include('../partials/utils/messages.ejs') %>
            <!--Table-->
            <div class="table-responsive shadow-lg p-3 mb-5 bg-white rounded">
                <table
                    id="myTable"
                    class="
                        table table-striped table-hover table-bordered table-sm
                        border-secondary
                        text-center
                        caption-top
                    "
                >
                    <caption>
                        List of Panoramas
                    </caption>
                    <thead class="table-dark">
                        <tr>
                            <th scope="col">
                                <i class="fas fa-image"></i> 
                                Image
                            </th>
                            <th scope="col">
                                <i
                                    onclick="sortTable(0)"
                                    class="fas fa-sort"
                                ></i>
                                Title
                            </th>
                            <th scope="col">
                                <i class="fas fa-compass"></i>
                                Location
                            </th>
                            <th scope="col">
                                <i class="fas fa-user-edit"></i>
                                Modified By
                            </th>
                            <th scope="col">
                                <i class="fas fa-calendar-alt"></i>
                                Date & Time Modified
                            </th>
                            <th scope="col">Update</th>
                            <th scope="col">Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% for(let panorama of panoramas) { %>
                        <tr>
                            <% panorama.images.forEach((img, i) => { %>
                            <td>
                                <img
                                    class="img-thumbnail card-img w-75"
                                    src="<%= img.thumbnail %>"
                                />
                            </td>
                            <% }) %>
                            <td class="align-middle"><%= panorama.title %></td>
                            <td class="align-middle">
                                <%= panorama.location %>
                            </td>
                            <td class="align-middle">
                                <%= panorama.author.name %>
                            </td>
                            <td class="align-middle">
                                <%= panorama.date.toLocaleString() %>
                            </td>
                            <td class="align-middle">
                                <a
                                    class="card-link btn btn-secondary"
                                    href="/panoramas/admin/<%= panorama._id %>/edit"
                                    ><i class="fas fa-edit"></i
                                ></a>
                            </td>
                            <!--* Delete Button  -->
                            <td class="align-middle">
                                <form
                                    class="d-inline"
                                    action="/panoramas/admin/list/:page"
                                    method="POST"
                                >
                                    <button
                                        class="btn btn-dark"
                                        name="deleteButton"
                                        value="<%= panorama._id %>"
                                        onclick="this.form.submit()"
                                    >
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </form>
                            </td>
                        </tr>
                        <% } %>
                    </tbody>
                </table>
                <!--Table-->
                <!--Pagination-->
                <div class="mt-3">
                    <% if (pages > 0) { %>
                    <ul class="pagination text-center">
                        <% if (current == 1) { %>
                        <li class="disabled">
                            <a class="page-link text-secondary">First</a>
                        </li>
                        <% } else { %>
                        <li>
                            <a
                                class="page-link text-secondary"
                                href="/panoramas/admin/list/1"
                                >First</a
                            >
                        </li>
                        <% } %> <% var i = (Number(current) > 5 ?
                        Number(current) - 4 : 1) %> <% if (i !== 1) { %>
                        <li class="disabled">
                            <a class="page-link text-secondary">...</a>
                        </li>
                        <% } %> <% for (; i <= (Number(current) + 4) && i <=
                        pages; i++) { %> <% if (i == current) { %>
                        <li class="active">
                            <a class="page-link text-secondary"><%= i %></a>
                        </li>
                        <% } else { %>
                        <li>
                            <a
                                class="page-link text-secondary"
                                href="/panoramas/admin/list/<%= i %>"
                                ><%= i %></a
                            >
                        </li>
                        <% } %> <% if (i == Number(current) + 4 && i < pages) {
                        %>
                        <li class="disabled">
                            <a class="page-link text-secondary">...</a>
                        </li>
                        <% } %> <% } %> <% if (current == pages) { %>
                        <li class="disabled">
                            <a class="page-link text-secondary">Last</a>
                        </li>
                        <% } else { %>
                        <li>
                            <a
                                class="page-link text-secondary"
                                href="/panoramas/admin/list/<%= pages %>"
                                >Last</a
                            >
                        </li>
                        <% } %>
                    </ul>
                    <% } %>
                </div>
                <!--Pagination-->
            </div>
        </main>
    </div>
</div>

<%-include("../partials/admin/admin-footer.ejs"); -%>
